<!DOCTYPE html>
<html>
<head>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="scripts/donut.js"></script>
  <script src="scripts/bar_chart.js"></script>
  <link href="styles/stylesheet.css" type="text/css" rel="stylesheet">
  <title>INFO 3300 Project 2</title>
</head>
<body>
  <div id="barchart"></div>
  <div id="clickBox">
    <img src="images/alcohol.png" height="64" width="64" class="alcohol_use" id="alc_icon"></img>
    <img src="images/marijuana.png" height="64" width="64" class="marijuana_use" id="mar_icon"></img>
    <img src="images/cocaine.png" height="64" width="64" class="cocaine_use" id="cocaine_icon"></img>
    <img src="images/heroin.png" height="64" width="64" class="heroin_use" id="heroin_icon"></img>
    <img src="images/hallucinogen.png" height="64" width="64" class="hallucinogen_use" id="hal_icon"></img>
    <img src="images/inhalant.png" height="64" width="64" class="inhalant_use" id="inhalant_icon"></img>
    <img src="images/pain_reliever.png" height="64" width="64" class="pain_reliever_use" id="pain_icon"></img>
    <img src="images/oxycontin.png" height="64" width="64" class="oxycontin_use" id="oxy_icon"></img>
    <img src="images/tranquilizer.png" height="64" width="64" class="tranquilizer_use" id="tranq_icon"></img>
    <img src="images/stimulant.png" height="64" width="64" class="stimulant_use" id="stim_icon"></img>
    <img src="images/meth.png" height="64" width="64" class="meth_use" id="meth_icon"></img>
    <img src="images/sedative.png" height="64" width="64" class="sedative_use" id="sedative_icon"></img>
  </div>
  <div id = "information">

    <!-- ALCOHOL -->
    <div id="alcohol_info">
      <h3> Alcohol </h3>
      <p> Alcohol is a a drink that contains ethanol. Drinking too much at once can cause a variety of problems related to the following:</p>
      <br>
      <ul>
        <li>Brain: Interferes with the brains communication pathways</li>
        <li>Heart: Can cause stroke, high blood pressure, irregular heart beat</li>
        <li>Pancreas: Can cause pancreatitis, which prevents proper digestion</li>
        <li>Cancers: Increases the risk of developing mouth, esophagus, throat, and other cancers </li>
      </ul>
      <br>
      <p>To learn more about alcohol's effect, please visit <a href="https://www.niaaa.nih.gov/alcohol-health/alcohols-effects-body">The National Institute on Alcohol Abuse and Alcoholism</a></p>

      <p>Have a problem with Alcohol? <a href="https://www.niaaa.nih.gov/alcohol-health/support-treatment">Alcoholism Help and Support</a></p>
    </div>

    <!-- MARIJUANA -->
    <div id="marijuana_info">
      <h3> Marijuana </h3>
      <p> Marijuana, also known as weed, is from the dried leaves of the Cannabis sativa plant. Marijuana is the most common illicit drug in the US, but lot of discussion has gone into legalizing it. Marijuana can cause the following:</p>
      <br>
      <ul>
        <li>Brain Overactivity </li>
        <li>Altered Senses</li>
        <li>Hallucinations</li>
        <li>Changes in mood</li>
        <li>Increased heart rate</li>
      </ul>
      <br>
      <p>To learn more about marijuana's effect, please visit <a href="https://www.drugabuse.gov/publications/drugfacts/marijuana">The National Institute on Drug Abuse</a></p>

      <p>Have a problem with Marijuana? <a href="https://www.recovery.org/topics/find-a-reputable-marijuana-addiction-recovery-hotline/">Marijuana Recovery</a></p>
    </div>

    <!-- COCAINE -->
    <div id="cocaine_info">
      <h3> Cocaine </h3>
      <p> Cocaine is an addictive, white stimulant drug powder. </p>
      <br>
      <ul>
        <li>Hypersensitivity to sight, sound, and touch</li>
        <li>Paranoia - extreme distrust of others</li>
        <li>Irritability</li>
        <li>Nausea</li>
        <li>Raised body temperature, blood pressure, heart rate</li>
      </ul>
      <br>
      <p>To learn more about cocaine's effect, please visit <a href="https://www.drugabuse.gov/publications/drugfacts/cocaine">The National Institute on Drug Abuse</a></p>

      <p>Have a problem with Cocaine? <a href="https://sunrisehouse.com/cocaine-addiction-treatment/">Cocaine Recovery</a></p>
    </div>



    <div id="heroin_info">
      <h3> Heroin </h3>
      <p> Heroin is an opioid drug made from morphine, a natural substance taken from the seed pod of the various opium poppy plants.</p>
      <br>
      <ul>
        <li>Nausea and vomiting</li>
        <li>Clouded mental functioning</li>
        <li>Heavy feeling in the arms and legs</li>
        <li>Going "on the nod," a back-and-forth state of being conscious and semiconscious</li>
        <li>Insomnia</li>
      </ul>
      <br>
      <p>To learn more about heroin's effect, please visit <a href="https://www.drugabuse.gov/publications/drugfacts/heroin">The National Institute on Drug Abuse</a></p>
      <p>Have a problem with Heroin? <a href="https://www.therecoveryvillage.com/heroin-addiction/heroin-hotline/#gref">Heroin Recovery</a></p>
    </div>

    <div id="hallucinogen_info">
      <h3> Hallucinogens </h3>
      <p>Hallucinogens are a diverse group of drugs that alter perception (awareness of surrounding objects and conditions), thoughts, and feelings.</p>
      <br>
      <ul>
        <li>Intensified feelings and sensory experiences</li>
        <li>Changes in sense of time (for example, time passing by slowly)</li>
        <li>Psychosisâ€”disordered thinking detached from reality</li>
        <li>Memory loss</li>
        <li>Paranoia</li>
      </ul>
      <br>
      <p>To learn more about hallucinogen's effect, please visit <a href="https://www.drugabuse.gov/publications/drugfacts/hallucinogens">The National Institute on Drug Abuse</a></p>
      <p>Have a problem with hallucinogens? <a href="https://www.recoveryconnection.com/substance-abuse/drug-classes/hallucinogen-addictioin-treatment-withdrawal/">Hallucinogen Recovery</a></p>
    </div>


    <div id="inhalant_info">
      <h3> Inhalants </h3>
      <p>Inhalants are various substances that people typically take only by inhaling</p>
      <br>
      <ul>
        <li>Slurred or distorted speech</li>
        <li>Lack of coordination (control of body movement)</li>
        <li>Loss of coordination and limb spasms (from nerve damage)</li>
        <li>Delayed behavioral development (from brain problems)</li>
        <li>Brain damage (from cut-off oxygen flow to the brain)</li>
      </ul>
      <br>
      <p>To learn more about inhalants' effect, please visit <a href="https://www.drugabuse.gov/publications/drugfacts/inhalants">The National Institute on Drug Abuse</a></p>
      <p>Have a problem with inhalants? <a href="https://www.recovery.org/topics/inhalant-recovery/">Inhalants Recovery</a></p>
     </div>

    <div id="pain_reliever_info">
      <h3>Pain Relievers</h3>
      <p>Pain Relievers are often prescription opioid medications used to manage pain of moderately high to very high severity. These often are abused.</p>
      <br>
      <ul>
        <li>Growing tolerance and increased risk of overdose</li>
        <li>Sleep apnea</li>
        <li>Falls and fractures</li>
        <li>Sexual dysfunction</li>
        <li>Coma</li>
      </ul>
      <br>
      <p>To learn more about pain killers' effect, please visit <a href="https://drugabuse.com/library/prescription-painkiller-faq/">drugabuse.com</a></p>
      <p>Have a problem with pain killers? <a href="https://www.therecoveryvillage.com/painkiller-addiction/side-effects/#gref">Pain Killers Recovery</a></p>
    </div>
    <div id="oxycontin_info"> <p> Information about oxycontin</p></div>
    <div id="tranquilizer_info"> <p> Information about tranquilizer</p></div>
    <div id="stimulant_info"> <p> Information about stimulants</p></div>
    <div id="meth_info"> <p> Information about meth</p></div>
    <div id="sedative_info"> <p> Information about sedative</p></div>


  </div>
  <!--Look at it so that the text in information is empty. Then when we hover over something, we change the inner text -->



  <div id="donut_chart_container">
    <h2>People Killed by Drugs in 2012</h2>
    <div id="donut_chart"></div>
    <p>
      * Stimulants have been grouped with methamphetamine.
    </p>
    <p>
      * According to the DEA, no one has died of marijuana overdose before.
      Its effects take place over time.
    </p>
    <p>
      * While hallucinogens have a reputation of being particularly deadly drugs,
      it is rare for a person to die strictly of any physical, overdose effects.
    </p>
    <p>
      * The number of lives claimed by inhalant abuse each year is unknown because
      these deaths often are attributed to other causes.
    </p>
  </div>
</body>
<script>

var donut = donutChart()
.width(980)
.height(600)
.cornerRadius(10) // sets how rounded the corners are on each slice
.padAngle(0.015) // effectively dictates the gap between slices
.variable('Percentage')
.category('Drug');

d3.csv('data/2012_people_killed_by_drugs.csv', function(error, data) {
  if (error) throw error;
  d3.select('#donut_chart')
  .datum(data) // bind data to the div
  .call(donut); // draw chart in div
});



//Set up the margins and width and height
var margin = {top: 50, left: 50, bottom: 50, right: 50}
var width = 750 - margin.left - margin.right
var height = 500 - margin.top - margin.bottom


//Create the SVG for the graph
var svg = d3.select("#barchart")
.append("svg")
.attr("width", width + margin.right + margin.left)
.attr("height", height + margin.top + margin.bottom)
.append("g")				//groups all the elements together

//Create a scaleBand, this has an ordinal domain and continuous range
var y = d3.scaleBand().rangeRound([0, height])
.paddingInner(0.30)
.align(0.5)

//Create a linearScale, this has a continuous range
var x = d3.scaleLinear().rangeRound([0, width])

//The color scheme for the graph
var color = d3.scaleOrdinal().range(["#420039", "#932F6D", "#E07BE0", "#DCCCFF", "#A077FF", "#FF00DD", "#2DB7BF",
"#E0DC62", "#FFCCDA", "#4C00FF", "#CCFFE2", "#ED2D70"])


var tooltip = svg.append("g")
.attr("class", "tooltip")
.style("display", "none");

tooltip.append("rect")
.attr("width", 60)
.attr("height", 20)
.attr("fill", "red")
.style("opacity", 0.5);

tooltip.append("text")
.attr("x", 30)
.attr("dy", "1.2em")
.style("text-anchor", "middle")
.attr("font-size", "12px")
.attr("font-weight", "bold");


//Read the CSV file
d3.csv("data/drug-use-by-age3.csv", function(d, i, columns) {
  for (i = 1, t = 0; i < columns.length; ++i)
  t += d[columns[i]] = +d[columns[i]]				//Need +d[columns[i]] to change the string value into a number
  d.total = t
  //console.log(d.total)
  //console.log(d)
  //Returns the row object
  return d
},
function (error, data){
  if (error) throw error;

  //Keys contains the headers
  var keys = data.columns.slice(1)
  console.log(keys)

  //Returns the ages in an array
  y.domain(data.map(function(d){return d.age}))

  //Set the domain of the x value to be from 0 to max
  x.domain([0, d3.max(data, function(d){return d.total})])

  //Maps the keys to the colors
  color.domain(keys)



  var tempKey;

  d3.select("g").append("g")

  .selectAll("g")
  .data(d3.stack().keys(keys)(data))
  .enter().append("g")
  .attr("fill", function(d) {return color(d.key); })
  .attr("opacity", "0.5")
  .attr("class", function(d) {return d.key})
  .selectAll("rect")
  .data(function(d) {return d;})
  .enter().append("rect")
  .attr("class", function(d){return d})
  .attr("y", function(d) {return y(d.data.age)})
  .attr("x", function(d) {return x(d[0])})
  .attr("width", function(d) { return x(d[1]) - x(d[0]); })
  .attr("height", y.bandwidth())
  .on("mouseover", function() { tooltip.style("display", null); })
    .on("mouseout", function() { tooltip.style("display", "none"); })
    .on("mousemove", function(d) {
      var xPosition = d3.mouse(this)[0] + 10;
      var yPosition = d3.mouse(this)[1] - 5;
      tooltip.attr("transform", "translate(" + xPosition + "," + yPosition + ")").style("pointer-events", "none");
      tooltip.select("text").text((d[1]-d[0]).toPrecision(3)+"%");
    });

    var tooltip = svg.append("g")
    .attr("class", "tooltip")
    .style("display", "none");

  tooltip.append("rect")
    .attr("width", 60)
    .attr("height", 20)
    .attr("fill", "white")
    .style("opacity", 0.5);

  tooltip.append("text")
    .attr("x", 30)
    .attr("dy", "1.2em")
    .style("text-anchor", "middle")
    .attr("font-size", "12px")
    .attr("font-weight", "bold");

  yAxis = d3.axisLeft(y)

  svg.append("g")
  .attr("transform", "translate(1000,0)")
  .call(yAxis);

hover();

})


</script>
</html>
